{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_ordemAtual","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_negociacaoService","NegociacaoService","_init","lista","then","negociacoes","forEach","adiciona","Negociacao","dado","_data","_quantidade","_valor","catch","texto","erro","importaNegociacoes","setInterval","coluna","inverteOrdem","ordena","a","b","importa","negociacao","apaga","esvazia","mensagem","event","preventDefault","_criaNegociacao","cadastra","console","log","_limpaFormulario","DateHelper","textoParaData","value","parseInt","parseFloat","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\n\n    constructor() {\n        let $ = document.querySelector.bind(document)\n\n        this._inputData = $(\"#data\")\n        this._inputQuantidade = $(\"#quantidade\")\n        this._inputValor = $(\"#valor\")\n\n        this._ordemAtual = ''\n\n        this._listaNegociacoes = new Bind(\n            new ListaNegociacoes(),\n            new NegociacoesView($('#negociacoesView')),\n            'adiciona', 'esvazia', 'ordena', 'inverteOrdem'\n        )\n\n        this._mensagem = new Bind(\n            new Mensagem(),\n            new MensagemView($(\"#mensagemView\")),\n            'texto'\n        )\n\n        this._negociacaoService = new NegociacaoService()\n\n        this._init()\n\n    }\n\n    _init() {\n\n        this._negociacaoService\n            .lista()\n            .then(negociacoes => negociacoes.forEach(dado => this._listaNegociacoes.adiciona(\n                new Negociacao(dado._data, dado._quantidade, dado._valor)\n            )))\n            .catch(erro => this._mensagem.texto = erro)\n        this.importaNegociacoes()\n        setInterval(() => {\n            this.importaNegociacoes()\n        }, 5000)\n    }\n\n    ordena(coluna) {\n        if (this._ordemAtual == coluna) return this._listaNegociacoes.inverteOrdem()\n        this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna])\n        this._ordemAtual = coluna\n    }\n\n    importaNegociacoes() {\n\n        this._negociacaoService\n            .importa(this._listaNegociacoes.negociacoes)\n            .then(negociacoes =>\n                negociacoes.forEach(negociacao => {\n                    this._listaNegociacoes.adiciona(negociacao);\n                    this._mensagem.texto = 'Negociações do período importadas'\n                }))\n            .catch(erro => this._mensagem.texto = erro)\n    }\n\n    apaga() {\n\n        this._negociacaoService\n            .apaga()\n            .then(mensagem => {\n                this._listaNegociacoes.esvazia()\n                this._mensagem.texto = mensagem\n            })\n            .catch(erro => this._mensagem.texto = erro)\n\n    }\n\n    adiciona(event) {\n        event.preventDefault()\n\n        let negociacao = this._criaNegociacao()\n\n        this._negociacaoService\n            .cadastra(negociacao)\n            .then(mensagem => {\n                console.log(mensagem)\n                this._listaNegociacoes.adiciona(negociacao)\n                this._mensagem.texto = 'Cadastro efetuado com sucesso'\n                this._limpaFormulario()\n            })\n            .catch(erro => this._mensagem.texto = erro)\n\n    }\n\n    _criaNegociacao() {\n        return new Negociacao(\n            DateHelper.textoParaData(this._inputData.value),\n            parseInt(this._inputQuantidade.value),\n            parseFloat(this._inputValor.value)\n        )\n    }\n\n    _limpaFormulario() {\n        this._inputData.value = ''\n        this._inputQuantidade.value = 1\n        this._inputValor.value = 0.0\n        this._inputData.focus()\n    }\n}"]}